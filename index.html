<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Web installer | Install | GrapheneOS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <script type="module" src="/js/fastboot/dist/fastboot.min.mjs"></script>
    <script type="module" src="./js/web-install.js"></script>
</head>
<body>
    <main id="web-install">
        <h1>Web installer</h1>

        <p>This is the WebUSB-based installer for GrapheneOS and is the recommended approach
        for most users.</p>

        <section id="unlocking-the-bootloader">
            <h2>Unlocking the bootloader</h2>
            <p>Unlock the bootloader to allow flashing the OS and firmware:</p>
            <button id="unlock-bootloader-button" disabled>Unlock bootloader</button>
            <p>The command needs to be confirmed on the device and will wipe all data. Use one
            of the volume buttons to switch the selection to accepting it and the power button to
            confirm.</p>
            <p><strong id="unlock-bootloader-status"></strong></p>
        </section>

        <section id="obtaining-factory-images">
            <h2>Obtaining factory images</h2>
            <p>You need to obtain the GrapheneOS factory images for your device to proceed with
            the installation process.</p>
            <button id="download-release-button" disabled>Download release</button>
            <div id="download-release-status-container" hidden>
                <strong id="download-release-status"></strong>
                <br/>
                <progress id="download-release-progress" hidden max="1" value="0"></progress>
            </div>
        </section>

        <section id="flashing-factory-images">
            <h2>Flashing factory images</h2>
            <p>The initial install will be performed by flashing the factory images. This will
            replace the existing OS installation and wipe all the existing data.</p>
            <button id="flash-release-button" disabled>Flash release</button>
            <div id="flash-release-status-container" hidden>
                <strong id="flash-release-status"></strong>
                <br/>
                <progress id="flash-release-progress" hidden max="1" value="0"></progress>
                <button id="flash-reconnect-button" hidden><strong>Reconnect device</strong></button>
            </div>
        </section>
        <section id="custom-flash-operations">
            <h2>Custom Flash Operations</h2>
            
            <div class="flash-operation">
                <h3>Flash Boot Image</h3>
                <input type="file" id="boot-file-input" accept=".img"/>
                <button id="flash-boot-button" >Flash Boot to All Slots</button>
                <div id="flash-boot-status-container" hidden>
                    <strong id="flash-boot-status"></strong>
                    <br/>
                    <progress id="flash-boot-progress" hidden max="1" value="0"></progress>
                </div>
            </div>
        
            <div class="flash-operation">
                <h3>Flash System Image</h3>
                <input type="file" id="system-file-input" accept=".img"/>
                <button id="flash-system-button" >Flash System to Userdata</button>
                <div id="flash-system-status-container" hidden>
                    <strong id="flash-system-status"></strong>
                    <br/>
                    <progress id="flash-system-progress" hidden max="1" value="0"></progress>
                </div>
            </div>
        
            <div class="flash-operation">
                <h3>Erase DTBO</h3>
                <button id="erase-dtbo-button">Erase DTBO (Both Slots)</button>
                <div id="erase-dtbo-status-container" hidden>
                    <strong id="erase-dtbo-status"></strong>
                </div>
            </div>
        </section>

        <section id="locking-the-bootloader">
            <h2>Locking the bootloader</h2>
            <p>Locking the bootloader is important as it enables full verified boot.</p>
            <button id="lock-bootloader-button" disabled>Lock bootloader</button>
            <p>The command needs to be confirmed on the device and will wipe all data. Use one
            of the volume buttons to switch the selection to accepting it and the power button to
            confirm.</p>
            <p><strong id="lock-bootloader-status"></strong></p>
        </section>

        <section id="replacing-grapheneos">
            <h2>Replacing GrapheneOS with the stock OS</h2>
            <p>Before flashing stock factory images, erase the custom Android Verified Boot key:</p>
            <button id="remove-custom-key-button" disabled>Remove non-stock key</button>
            <p><strong id="remove-custom-key-status"></strong></p>
        </section>
    </main>
</body>
</html>